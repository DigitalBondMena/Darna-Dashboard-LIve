"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[9659],{9659:(O,h,a)=>{a.r(h),a.d(h,{UsersManagement:()=>V});var n=a(8728),l=a(3597),o=a(4341),p=a(9211),f=a(1256),v=a(6677),M=a(5779),E=a(3314),e=a(3664),b=a(2200),U=a(1020),F=a(1914),y=a(5506);const g=t=>({backgroundColor:t});function C(t,d){1&t&&(e.j41(0,"small",16),e.EFF(1," Name is required and must be at least 3 characters long. "),e.k0s())}function I(t,d){1&t&&(e.j41(0,"small",16),e.EFF(1," username is required "),e.k0s())}function D(t,d){1&t&&(e.j41(0,"small",16),e.EFF(1," password is required and must be at least 8 characters long. "),e.k0s())}function w(t,d){if(1&t&&(e.j41(0,"div",13)(1,"label",17),e.EFF(2," Password "),e.k0s(),e.nrm(3,"input",18),e.DNE(4,D,2,0,"small",10),e.k0s()),2&t){let s,i;const r=e.XpG();e.R7$(3),e.Aen(e.eq3(6,g,r.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(s=r.careerForm.get("password"))?null:s.invalid)&&(null==(s=r.careerForm.get("password"))?null:s.touched)),e.Y8G("readonly",r.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(i=r.careerForm.get("password"))?null:i.invalid)&&(null==(i=r.careerForm.get("password"))?null:i.touched)&&!r.isViewMode())}}function P(t,d){if(1&t&&(e.qex(0),e.nrm(1,"p-button",19),e.bVm()),2&t){const s=e.XpG();e.R7$(),e.Y8G("disabled",s.careerForm.invalid||s.isLoading())("loading",s.isLoading())}}function T(t,d){if(1&t&&(e.qex(0),e.nrm(1,"p-button",20),e.bVm()),2&t){const s=e.XpG();e.R7$(),e.Y8G("disabled",!s.careerForm.valid&&!s.isViewMode())("loading",s.isLoading())}}function R(t,d){if(1&t){const s=e.RV6();e.qex(0),e.j41(1,"p-button",21),e.bIt("click",function(){n.eBV(s);const r=e.XpG();return n.Njj(r.onCancel())}),e.k0s(),e.j41(2,"p-button",22),e.bIt("click",function(){n.eBV(s);const r=e.XpG();return n.Njj(r.onEditcareer())}),e.k0s(),e.bVm()}}let V=(()=>{class t{constructor(){this.usersManagementService=(0,n.WQX)(E.z),this.fb=(0,n.WQX)(o.ok),this.messageService=(0,n.WQX)(M.bg),this.route=(0,n.WQX)(p.nX),this.router=(0,n.WQX)(p.Ix),this.mode=(0,n.vPA)("create"),this.UserId=(0,n.vPA)(null),this.isLoading=(0,n.vPA)(!1),this.baseUrl=f.p,this.isEditMode=(0,l.EW)(()=>"edit"===this.mode()),this.isCreateMode=(0,l.EW)(()=>"create"===this.mode()),this.isViewMode=(0,l.EW)(()=>"view"===this.mode()),this.isFormValid=(0,l.EW)(()=>{if(!this.user)return!1;const s=this.careerForm.valid;return this.isCreateMode(),s}),this.pageTitle=(0,l.EW)(()=>{switch(this.mode()){case"create":return"Create New User";case"edit":return"Edit User Mode";case"view":return"View User Mode";default:return"User Form"}}),(0,l.QZ)(()=>{this.user&&(this.isViewMode()?this.careerForm.disable():this.careerForm.enable())})}ngOnInit(){this.initForm(),this.setupRouteHandling()}setupRouteHandling(){this.route.data.subscribe(s=>{this.mode.set(s.mode||"create")}),this.route.params.subscribe(s=>{const i=s.id;i&&(this.UserId.set(+i),this.loadcareerData(+i))})}initForm(){this.careerForm=this.fb.group({name:["",[o.k0.required]],email:["",[o.k0.required]],password:["",[o.k0.required,o.k0.minLength(8)]]})}loadcareerData(s){const i=s||this.UserId()||1;this.usersManagementService.getUser(i).subscribe({next:r=>{this.user=r.data,console.log(this.user),this.user=r.data,this.careerForm.patchValue({name:r.data.name,email:r.data.email}),this.isLoading.set(!1)},error:r=>{console.error("Error loading career data:",r),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load User data"}),this.isLoading.set(!1)}})}onSubmit(){if(this.careerForm.invalid||this.isViewMode())return;this.isLoading.set(!0);const s=this.careerForm.value;this.isCreateMode()?this.createUser(s):this.isEditMode()&&this.updateCareer()}createUser(s){this.usersManagementService.createUser(s).subscribe({next:i=>{console.log("Create successful:",i),this.messageService.add({severity:"success",summary:"Success",detail:"User created successfully"}),this.router.navigate(["/dashboard/users-management"])},error:i=>{console.error("Error creating Careers:",i),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create User"}),this.isLoading.set(!1)}})}updateCareer(){if(console.log(this.careerForm),this.careerForm.valid){this.isLoading.set(!0);const s=this.careerForm.get("password").value;this.usersManagementService.updateUser(this.user.id,s).subscribe({next:()=>{this.messageService.add({severity:"success",summary:"Success",detail:"User updated successfully"}),this.isLoading.set(!1)},error:()=>{this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update User"}),this.isLoading.set(!1)}})}else this.messageService.add({severity:"warn",summary:"Warning",detail:"Please fill all required fields correctly"})}onCancel(){this.router.navigate(["/dashboard/users-management"])}onEditcareer(){this.UserId()&&this.router.navigate(["../../edit",this.UserId()],{relativeTo:this.route})}static#e=this.\u0275fac=function(i){return new(i||t)};static#r=this.\u0275cmp=e.VBU({type:t,selectors:[["app-users-management-id"]],decls:23,vars:22,consts:[[1,"grid"],[1,"col-12"],["styleClass","shadow-2",3,"header"],[1,"p-fluid"],[3,"ngSubmit","formGroup"],[1,"mt-4"],[1,"row"],[1,"field","mb-3","col-6"],["for","name",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","name","formControlName","name","placeholder","Enter name",2,"width","100%",3,"readonly"],["class","p-error block",4,"ngIf"],["for","email",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","email","formControlName","email","placeholder","Enter username",2,"width","100%",3,"readonly"],[1,"field","mb-3","col-12"],[1,"flex","justify-content-end","gap-2","pt-3"],[4,"ngIf"],[1,"p-error","block"],["for","password",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","password","formControlName","password","type","password","placeholder","Enter password",2,"width","100%",3,"readonly"],["label","Create User","icon","pi pi-plus","severity","primary","type","submit",3,"disabled","loading"],["label","Update User","icon","pi pi-check","severity","primary","type","submit",3,"disabled","loading"],["label","Back","icon","pi pi-arrow-left","severity","secondary","type","button",3,"click"],["label","Edit","icon","pi pi-pencil","severity","primary","type","button",3,"click"]],template:function(i,r){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"p-card",2)(3,"div",3)(4,"form",4),e.bIt("ngSubmit",function(){return r.onSubmit()}),e.j41(5,"div",5)(6,"div",6)(7,"div",7)(8,"label",8),e.EFF(9," Name "),e.k0s(),e.nrm(10,"input",9),e.DNE(11,C,2,0,"small",10),e.k0s(),e.j41(12,"div",7)(13,"label",11),e.EFF(14," Username "),e.k0s(),e.nrm(15,"input",12),e.DNE(16,I,2,0,"small",10),e.k0s(),e.nVh(17,w,5,8,"div",13),e.j41(18,"div",1)(19,"div",14),e.DNE(20,P,2,2,"ng-container",15)(21,T,2,2,"ng-container",15)(22,R,3,0,"ng-container",15),e.k0s()()()()()()()()()),2&i){let m,c,u,_;e.R7$(2),e.Y8G("header",r.pageTitle()),e.R7$(2),e.Y8G("formGroup",r.careerForm),e.R7$(6),e.Aen(e.eq3(18,g,r.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(m=r.careerForm.get("name"))?null:m.invalid)&&(null==(m=r.careerForm.get("name"))?null:m.touched)),e.Y8G("readonly",r.isViewMode()||r.isEditMode()),e.R7$(),e.Y8G("ngIf",(null==(c=r.careerForm.get("name"))?null:c.invalid)&&(null==(c=r.careerForm.get("name"))?null:c.touched)&&!r.isViewMode()),e.R7$(4),e.Aen(e.eq3(20,g,r.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(u=r.careerForm.get("email"))?null:u.invalid)&&(null==(u=r.careerForm.get("email"))?null:u.touched)),e.Y8G("readonly",r.isViewMode()||r.isEditMode()),e.R7$(),e.Y8G("ngIf",(null==(_=r.careerForm.get("email"))?null:_.invalid)&&(null==(_=r.careerForm.get("email"))?null:_.touched)&&!r.isViewMode()),e.R7$(),e.vxM(r.isViewMode()?-1:17),e.R7$(3),e.Y8G("ngIf",r.isCreateMode()),e.R7$(),e.Y8G("ngIf",r.isEditMode()),e.R7$(),e.Y8G("ngIf",r.isViewMode())}},dependencies:[v.Y,b.bT,U.$n,F.Sm,y.Zp,o.qT,o.me,o.BC,o.cb,o.j4,o.JD],styles:[".p-fileupload-upload-button{display:none!important}  .p-fileupload-file-badge{display:none!important}  .ql-disabled .ql-editor{background-color:#cbd5e1!important;color:#475569}.rtl-editor[_ngcontent-%COMP%]     .ql-editor{text-align:right!important}"]})}return t})()}}]);