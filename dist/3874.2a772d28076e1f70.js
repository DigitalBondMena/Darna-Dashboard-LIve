"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[3874],{3874:(W,g,r)=>{r.r(g),r.d(g,{Projects:()=>B});var n=r(8728),j=r(9211),E=r(1256),v=r(202),T=r(5731),u=r(5779),m=r(1914),P=r(2256),f=r(1314),C=r(980),t=r(3664),p=r(5531),M=r(8132),h=r(4341),R=r(2292),F=r(1020);const O=()=>["create"],D=()=>({"min-width":"50rem"}),I=()=>({width:"50px",height:"50px",borderRadius:"50%"}),S=a=>["view",a],b=a=>["edit",a];function y(a,d){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"th",13),t.EFF(2," ID "),t.nrm(3,"p-sortIcon",14),t.k0s(),t.j41(4,"th",15),t.EFF(5," Title "),t.nrm(6,"p-sortIcon",16),t.k0s(),t.j41(7,"th"),t.EFF(8,"Image"),t.k0s(),t.j41(9,"th",15),t.EFF(10," Name "),t.nrm(11,"p-sortIcon",16),t.k0s(),t.j41(12,"th"),t.EFF(13,"View"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Edit"),t.k0s(),t.j41(16,"th",17)(17,"div",18)(18,"span"),t.EFF(19,"Status"),t.k0s(),t.j41(20,"p-select",19),t.mxI("ngModelChange",function(i){n.eBV(e);const o=t.XpG();return t.DH7(o.selectedStatusFilter,i)||(o.selectedStatusFilter=i),n.Njj(i)}),t.bIt("ngModelChange",function(i){n.eBV(e);const o=t.XpG();return n.Njj(o.onStatusFilter(i))}),t.k0s()()()()}if(2&a){const e=t.XpG();t.R7$(20),t.Y8G("options",e.statusOptions),t.R50("ngModel",e.selectedStatusFilter),t.Y8G("showClear",!0)}}function w(a,d){1&a&&t.nrm(0,"i",27)}function L(a,d){if(1&a){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td",20),t.EFF(4),t.k0s(),t.j41(5,"td"),t.nrm(6,"img",21),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"a",22),t.nrm(11,"i",23),t.k0s()(),t.j41(12,"td")(13,"a",22),t.nrm(14,"i",24),t.k0s()(),t.j41(15,"td")(16,"div",25)(17,"p-toggleswitch",26),t.bIt("ngModelChange",function(){const i=n.eBV(e).$implicit,o=t.XpG();return n.Njj(o.onToggleChange(i))}),t.k0s(),t.nVh(18,w,1,0,"i",27),t.k0s()()()}if(2&a){const e=d.$implicit,s=t.XpG();t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.en_project_name),t.R7$(2),t.Aen(t.lJ4(11,I)),t.Y8G("src",s.baseUrl+e.main_image,t.B4B),t.R7$(2),t.JRh(e.en_project_name),t.R7$(2),t.Y8G("routerLink",t.eq3(12,S,e.id)),t.R7$(3),t.Y8G("routerLink",t.eq3(14,b,e.id)),t.R7$(4),t.Y8G("ngModel",s.returnStatus(e.active_status))("disabled",s.isToggleLoading(e.id)),t.R7$(),t.vxM(s.isToggleLoading(e.id)?18:-1)}}function x(a,d){1&a&&(t.j41(0,"tr")(1,"td",28)(2,"div",29),t.nrm(3,"i",30),t.j41(4,"span",31),t.EFF(5,"No data found"),t.k0s()()()())}let B=(()=>{class a{constructor(){this.route=(0,n.WQX)(j.nX),this.messageService=(0,n.WQX)(u.bg),this.baseUrl=E.p,this.projectService=(0,n.WQX)(v.i),this.checked=!1,this.loadingToggles=new Set,this.statusOptions=[{label:"Active",value:1},{label:"Inactive",value:0}],this.selectedStatusFilter=null,this.searchTerm="",this.first=0,this.rows=10,this.totalRecords=0,this.rowsPerPageOptions=[10,50,100,200]}get paginationOptions(){if(0===this.rowsPerPageOptions.length)return[];const e=[...this.rowsPerPageOptions];return this.totalRecords>0&&this.totalRecords>Math.max(...this.rowsPerPageOptions)&&e.push(this.totalRecords),e}getMode(){return this.route.snapshot.queryParamMap.get("mode")}getSliderId(){return this.route.snapshot.queryParamMap.get("id")}ngOnInit(){this.projectService.getProjects().subscribe(e=>{this.allProjects=e.data,this.projects=e.data,this.applyFilters(),console.log(this.projects[0])})}returnStatus(e){return 1==e}isToggleLoading(e){return this.loadingToggles.has(e)}applyFilters(){let e=[...this.allProjects];this.searchTerm.trim()&&(e=e.filter(s=>s.en_project_name.toLowerCase().includes(this.searchTerm.toLowerCase()))),null!=this.selectedStatusFilter&&(e=e.filter(s=>Number(s.active_status)===Number(this.selectedStatusFilter))),this.filteredProjects=e,this.totalRecords=e.length,this.updateDisplayedProjects()}updateDisplayedProjects(){this.projects=this.rows>=this.totalRecords||-1===this.rows?[...this.filteredProjects]:this.filteredProjects.slice(this.first,this.first+this.rows)}onSearch(){this.first=0,this.applyFilters()}onPageChange(e){this.first=e.first??0,this.rows=e.rows??10,this.updateDisplayedProjects()}onToggleChange(e){if(this.isToggleLoading(e.id))return;this.loadingToggles.add(e.id);const s=e.active_status,i=1===Number(e.active_status)?"0":"1";e.active_status=i;const o=this.allProjects.findIndex(l=>l.id===e.id);-1!==o&&(this.allProjects[o].active_status=i),(1===Number(s)?this.projectService.disableProject(e.id):this.projectService.activeProject(e.id)).pipe((0,C.j)(()=>{this.loadingToggles.delete(e.id)})).subscribe({next:l=>{if(l.data&&l.data.length>0){const _=l.data.find(k=>k.id===e.id);_&&(e.active_status=_.active_status,-1!==o&&(this.allProjects[o].active_status=_.active_status))}this.applyFilters(),this.messageService.add({severity:"success",summary:"Success",detail:`Project ${1===Number(i)?"activated":"deactivated"} successfully`})},error:l=>{e.active_status=s,-1!==o&&(this.allProjects[o].active_status=s),this.applyFilters(),console.error("Toggle failed:",l),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update project status"})}})}getStatusOption(e){return e}onStatusFilter(e){this.selectedStatusFilter=e,this.first=0,this.applyFilters()}onStatusChange(e){const s=this.allProjects.find(i=>i.id===e);s&&this.onToggleChange(s)}refreshData(){this.projectService.getProjects().subscribe(e=>{this.allProjects=e.data,this.applyFilters()})}onDelete(e){const s=this.allProjects.find(i=>i.id===e);s&&this.onToggleChange(s)}onActive(e){const s=this.allProjects.find(i=>i.id===e);s&&this.onToggleChange(s)}static#t=this.\u0275fac=function(s){return new(s||a)};static#e=this.\u0275cmp=t.VBU({type:a,selectors:[["app-projects"]],decls:16,vars:15,consts:[[1,"flex","justify-content-between","items-center","mb-4","w-full"],["label","Create New Project","icon","pi pi-plus","severity","primary",3,"routerLink"],[1,"mb-4"],[1,"flex","gap-4","align-items-center"],[1,"flex-1"],["for","search",1,"block","text-sm","font-medium","mb-2"],["pInputText","","id","search","placeholder","Enter project name to search...","styleClass","w-full",1,"w-full",3,"ngModelChange","input","ngModel"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"mt-4"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showPageLinks","showCurrentPageReport","showFirstLastIcon","showJumpToPageDropdown","showJumpToPageInput"],["pSortableColumn","id"],["field","id"],["pSortableColumn","en_project_name"],["field","en_project_name"],["pSortableColumn","active_status",2,"max-width","50px"],[1,"flex","flex-column","gap-2"],["optionLabel","label","optionValue","value","appendTo","body","placeholder","Filter by Status",3,"ngModelChange","options","ngModel","showClear"],[2,"width","25%"],["alt","project",3,"src"],[3,"routerLink"],[1,"pi","pi-eye",2,"color","#673ab7"],[1,"pi","pi-pencil",2,"color","#673ab7"],[1,"flex","align-items-center","gap-2"],[3,"ngModelChange","ngModel","disabled"],[1,"pi","pi-spin","pi-spinner",2,"color","#673ab7","font-size","0.8rem"],["colspan","7",1,"text-center","p-4"],[1,"flex","flex-column","align-items-center","justify-content-center"],[1,"pi","pi-info-circle",2,"font-size","2rem","color","var(--text-color-secondary)"],[1,"mt-2",2,"color","var(--text-color-secondary)"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2,"Projects Management"),t.k0s(),t.nrm(3,"p-button",1),t.k0s(),t.j41(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5),t.EFF(8,"Search by Project Name:"),t.k0s(),t.j41(9,"input",6),t.mxI("ngModelChange",function(c){return t.DH7(i.searchTerm,c)||(i.searchTerm=c),c}),t.bIt("input",function(){return i.onSearch()}),t.k0s()()()(),t.j41(10,"p-table",7),t.DNE(11,y,21,3,"ng-template",8)(12,L,19,16,"ng-template",9)(13,x,6,0,"ng-template",10),t.k0s(),t.j41(14,"div",11)(15,"p-paginator",12),t.bIt("onPageChange",function(c){return i.onPageChange(c)}),t.k0s()()),2&s&&(t.R7$(3),t.Y8G("routerLink",t.lJ4(13,O)),t.R7$(6),t.R50("ngModel",i.searchTerm),t.R7$(),t.Y8G("value",i.projects)("tableStyle",t.lJ4(14,D)),t.R7$(5),t.Y8G("first",i.first)("rows",i.rows)("totalRecords",i.totalRecords)("rowsPerPageOptions",i.paginationOptions)("showPageLinks",!0)("showCurrentPageReport",!0)("showFirstLastIcon",!0)("showJumpToPageDropdown",!1)("showJumpToPageInput",!1))},dependencies:[T.g,p.XI,u.Ei,p.Tg,p.yc,M.Wk,h.me,h.BC,h.vS,R.jF,F.$n,f.py,f.l6,m.um,m.Sm,P.IP,P.mg],encapsulation:2})}return a})()}}]);