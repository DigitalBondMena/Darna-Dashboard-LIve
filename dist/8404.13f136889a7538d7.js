"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[8404],{8404:(W,p,l)=>{l.r(p),l.d(p,{Blogs:()=>x});var n=l(8728),v=l(9211),P=l(1256),B=l(8309),T=l(5731),u=l(5779),m=l(1914),f=l(2256),E=l(1314),C=l(980),t=l(3664),h=l(5531),M=l(8132),c=l(4341),b=l(2292),R=l(1020);const F=()=>["create"],O=()=>({"min-width":"50rem"}),D=()=>({width:"50px",height:"50px",borderRadius:"50%"}),I=o=>["view",o],S=o=>["edit",o];function y(o,d){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"th",13),t.EFF(2," ID "),t.nrm(3,"p-sortIcon",14),t.k0s(),t.j41(4,"th",15),t.EFF(5," Title "),t.nrm(6,"p-sortIcon",16),t.k0s(),t.j41(7,"th"),t.EFF(8,"Image"),t.k0s(),t.j41(9,"th",17),t.EFF(10," Date "),t.nrm(11,"p-sortIcon",18),t.k0s(),t.j41(12,"th"),t.EFF(13,"View"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Edit"),t.k0s(),t.j41(16,"th",19)(17,"div",20)(18,"span"),t.EFF(19,"Status"),t.k0s(),t.j41(20,"p-select",21),t.mxI("ngModelChange",function(i){n.eBV(e);const a=t.XpG();return t.DH7(a.selectedStatusFilter,i)||(a.selectedStatusFilter=i),n.Njj(i)}),t.bIt("ngModelChange",function(i){n.eBV(e);const a=t.XpG();return n.Njj(a.onStatusFilter(i))}),t.k0s()()()()}if(2&o){const e=t.XpG();t.R7$(20),t.Y8G("options",e.statusOptions),t.R50("ngModel",e.selectedStatusFilter),t.Y8G("showClear",!0)}}function w(o,d){1&o&&t.nrm(0,"i",29)}function j(o,d){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td",22),t.EFF(4),t.k0s(),t.j41(5,"td"),t.nrm(6,"img",23),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"a",24),t.nrm(11,"i",25),t.k0s()(),t.j41(12,"td")(13,"a",24),t.nrm(14,"i",26),t.k0s()(),t.j41(15,"td")(16,"div",27)(17,"p-toggleswitch",28),t.bIt("ngModelChange",function(){const i=n.eBV(e).$implicit,a=t.XpG();return n.Njj(a.onToggleChange(i))}),t.k0s(),t.nVh(18,w,1,0,"i",29),t.k0s()()()}if(2&o){const e=d.$implicit,s=t.XpG();t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.en_blog_title),t.R7$(2),t.Aen(t.lJ4(11,D)),t.Y8G("src",s.baseUrl+e.main_image,t.B4B),t.R7$(2),t.JRh(e.blog_date),t.R7$(2),t.Y8G("routerLink",t.eq3(12,I,e.id)),t.R7$(3),t.Y8G("routerLink",t.eq3(14,S,e.id)),t.R7$(4),t.Y8G("ngModel",s.returnStatus(e.active_status))("disabled",s.isToggleLoading(e.id)),t.R7$(),t.vxM(s.isToggleLoading(e.id)?18:-1)}}function L(o,d){1&o&&(t.j41(0,"tr")(1,"td",30)(2,"div",31),t.nrm(3,"i",32),t.j41(4,"span",33),t.EFF(5,"No data found"),t.k0s()()()())}let x=(()=>{class o{constructor(){this.route=(0,n.WQX)(v.nX),this.messageService=(0,n.WQX)(u.bg),this.baseUrl=P.p,this.blogService=(0,n.WQX)(B.c),this.checked=!1,this.loadingToggles=new Set,this.statusOptions=[{label:"Active",value:1},{label:"Inactive",value:0}],this.selectedStatusFilter=null,this.searchTerm="",this.first=0,this.rows=10,this.totalRecords=0,this.rowsPerPageOptions=[10,50,100,200]}get paginationOptions(){if(0===this.rowsPerPageOptions.length)return[];const e=[...this.rowsPerPageOptions];return this.totalRecords>0&&this.totalRecords>Math.max(...this.rowsPerPageOptions)&&e.push(this.totalRecords),e}getMode(){return this.route.snapshot.queryParamMap.get("mode")}getSliderId(){return this.route.snapshot.queryParamMap.get("id")}ngOnInit(){this.blogService.getBlogs().subscribe(e=>{this.allBlogs=e.data,this.blogs=e.data,this.applyFilters(),console.log(this.blogs[0])})}returnStatus(e){return 1==e}isToggleLoading(e){return this.loadingToggles.has(e)}applyFilters(){let e=[...this.allBlogs];this.searchTerm.trim()&&(e=e.filter(s=>s.en_blog_title.toLowerCase().includes(this.searchTerm.toLowerCase()))),null!=this.selectedStatusFilter&&(e=e.filter(s=>Number(s.active_status)===Number(this.selectedStatusFilter))),this.filteredBlogs=e,this.totalRecords=e.length,this.updateDisplayedBlogs()}updateDisplayedBlogs(){this.blogs=this.rows>=this.totalRecords||-1===this.rows?[...this.filteredBlogs]:this.filteredBlogs.slice(this.first,this.first+this.rows)}onSearch(){this.first=0,this.applyFilters()}onPageChange(e){this.first=e.first??0,this.rows=e.rows??10,this.updateDisplayedBlogs()}onToggleChange(e){if(this.isToggleLoading(e.id))return;this.loadingToggles.add(e.id);const s=e.active_status,i=1===Number(e.active_status)?"0":"1";e.active_status=i;const a=this.allBlogs.findIndex(r=>r.id===e.id);-1!==a&&(this.allBlogs[a].active_status=i),(1===Number(s)?this.blogService.disableBlog(e.id):this.blogService.activeBlog(e.id)).pipe((0,C.j)(()=>{this.loadingToggles.delete(e.id)})).subscribe({next:r=>{if(r.data&&r.data.length>0){const _=r.data.find(k=>k.id===e.id);_&&(e.active_status=_.active_status,-1!==a&&(this.allBlogs[a].active_status=_.active_status))}this.applyFilters(),this.messageService.add({severity:"success",summary:"Success",detail:`Blog ${1===Number(i)?"activated":"deactivated"} successfully`})},error:r=>{e.active_status=s,-1!==a&&(this.allBlogs[a].active_status=s),this.applyFilters(),console.error("Toggle failed:",r),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update blog status"})}})}getStatusOption(e){return e}onStatusFilter(e){this.selectedStatusFilter=e,this.first=0,this.applyFilters()}onStatusChange(e){const s=this.allBlogs.find(i=>i.id===e);s&&this.onToggleChange(s)}refreshData(){this.blogService.getBlogs().subscribe(e=>{this.allBlogs=e.data,this.applyFilters()})}onDelete(e){const s=this.allBlogs.find(i=>i.id===e);s&&this.onToggleChange(s)}onActive(e){const s=this.allBlogs.find(i=>i.id===e);s&&this.onToggleChange(s)}static#t=this.\u0275fac=function(s){return new(s||o)};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["app-blogs"]],decls:16,vars:15,consts:[[1,"flex","justify-content-between","items-center","mb-4","w-full"],["label","Create New Blog","icon","pi pi-plus","severity","primary",3,"routerLink"],[1,"mb-4"],[1,"flex","gap-4","align-items-center"],[1,"flex-1"],["for","search",1,"block","text-sm","font-medium","mb-2"],["pInputText","","id","search","placeholder","Enter blog title to search...","styleClass","w-full",1,"w-full",3,"ngModelChange","input","ngModel"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"mt-4"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showPageLinks","showCurrentPageReport","showFirstLastIcon","showJumpToPageDropdown","showJumpToPageInput"],["pSortableColumn","id"],["field","id"],["pSortableColumn","en_blog_title"],["field","en_blog_title"],["pSortableColumn","blog_date"],["field","blog_date"],["pSortableColumn","active_status",2,"max-width","50px"],[1,"flex","flex-column","gap-2"],["optionLabel","label","optionValue","value","appendTo","body","placeholder","Filter by Status",3,"ngModelChange","options","ngModel","showClear"],[2,"width","25%"],["alt","blog",3,"src"],[3,"routerLink"],[1,"pi","pi-eye",2,"color","#673ab7"],[1,"pi","pi-pencil",2,"color","#673ab7"],[1,"flex","align-items-center","gap-2"],[3,"ngModelChange","ngModel","disabled"],[1,"pi","pi-spin","pi-spinner",2,"color","#673ab7","font-size","0.8rem"],["colspan","7",1,"text-center","p-4"],[1,"flex","flex-column","align-items-center","justify-content-center"],[1,"pi","pi-info-circle",2,"font-size","2rem","color","var(--text-color-secondary)"],[1,"mt-2",2,"color","var(--text-color-secondary)"]],template:function(s,i){1&s&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2,"Blogs Management"),t.k0s(),t.nrm(3,"p-button",1),t.k0s(),t.j41(4,"div",2)(5,"div",3)(6,"div",4)(7,"label",5),t.EFF(8,"Search by Title:"),t.k0s(),t.j41(9,"input",6),t.mxI("ngModelChange",function(g){return t.DH7(i.searchTerm,g)||(i.searchTerm=g),g}),t.bIt("input",function(){return i.onSearch()}),t.k0s()()()(),t.j41(10,"p-table",7),t.DNE(11,y,21,3,"ng-template",8)(12,j,19,16,"ng-template",9)(13,L,6,0,"ng-template",10),t.k0s(),t.j41(14,"div",11)(15,"p-paginator",12),t.bIt("onPageChange",function(g){return i.onPageChange(g)}),t.k0s()()),2&s&&(t.R7$(3),t.Y8G("routerLink",t.lJ4(13,F)),t.R7$(6),t.R50("ngModel",i.searchTerm),t.R7$(),t.Y8G("value",i.blogs)("tableStyle",t.lJ4(14,O)),t.R7$(5),t.Y8G("first",i.first)("rows",i.rows)("totalRecords",i.totalRecords)("rowsPerPageOptions",i.paginationOptions)("showPageLinks",!0)("showCurrentPageReport",!0)("showFirstLastIcon",!0)("showJumpToPageDropdown",!1)("showJumpToPageInput",!1))},dependencies:[T.g,h.XI,u.Ei,h.Tg,h.yc,M.Wk,c.me,c.BC,c.vS,b.jF,R.$n,E.py,E.l6,m.um,m.Sm,f.IP,f.mg],styles:["ul.p-select-list[_ngcontent-%COMP%]{padding:10 0!important}"]})}return o})()}}]);