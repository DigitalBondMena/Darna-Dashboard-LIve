"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[9361],{9361:(X,F,o)=>{o.r(F),o.d(F,{Counter:()=>K});var a=o(8728),d=o(3597),l=o(4341),C=o(9211),M=o(1256),I=o(6677),y=o(5779),k=o(5512),e=o(3664),D=o(4781),T=o(2200),R=o(1020),V=o(1914),P=o(5506),A=o(886);const m=n=>({backgroundColor:n});function L(n,s){1&n&&(e.j41(0,"small",26),e.EFF(1," Counter title is required and must be at least 3 characters long. "),e.k0s())}function j(n,s){1&n&&(e.j41(0,"small",26),e.EFF(1," Alt image text is required. "),e.k0s())}function w(n,s){1&n&&(e.j41(0,"small",26),e.EFF(1," Counter title is required and must be at least 3 characters long. "),e.k0s())}function G(n,s){1&n&&(e.j41(0,"small",26),e.EFF(1," Alt image text is required. "),e.k0s())}function O(n,s){if(1&n&&(e.j41(0,"div",2)(1,"div",27)(2,"label",28),e.EFF(3),e.k0s(),e.j41(4,"div",29),e.nrm(5,"img",30),e.k0s()()()),2&n){const i=e.XpG();e.R7$(3),e.JRh(i.isViewMode()?"Image":"Current Image"),e.R7$(2),e.Y8G("src",i.baseUrl+i.counter.main_image,e.B4B)("alt",i.counter.en_alt_image)}}function S(n,s){1&n&&(e.j41(0,"small",26),e.EFF(1," Counter number is required and must be a valid number. "),e.k0s())}function B(n,s){1&n&&(e.j41(0,"span",35),e.EFF(1,"*"),e.k0s())}function W(n,s){1&n&&(e.j41(0,"div",36),e.nrm(1,"i",37),e.j41(2,"p",38),e.EFF(3," Drag and drop an image here or click to select "),e.k0s()())}function $(n,s){1&n&&(e.j41(0,"small",39),e.EFF(1," Image is required for creating a new counter. "),e.k0s())}function Y(n,s){if(1&n){const i=e.RV6();e.j41(0,"div",31)(1,"label",28),e.EFF(2," Upload New Image "),e.DNE(3,B,2,0,"span",32),e.k0s(),e.j41(4,"p-fileupload",33),e.bIt("onSelect",function(t){a.eBV(i);const u=e.XpG();return a.Njj(u.onImageSelect(t))}),e.DNE(5,W,4,0,"ng-template",null,0,e.C5r),e.k0s(),e.DNE(7,$,2,0,"small",34),e.k0s()}if(2&n){let i;const r=e.XpG();e.R7$(3),e.Y8G("ngIf",r.isCreateMode()),e.R7$(),e.Y8G("multiple",!1)("auto",!1),e.R7$(3),e.Y8G("ngIf",r.isCreateMode()&&!r.selectedFile&&(null==(i=r.counterForm.get("main_image"))?null:i.invalid))}}function U(n,s){if(1&n&&(e.qex(0),e.nrm(1,"p-button",40),e.bVm()),2&n){const i=e.XpG();e.R7$(),e.Y8G("loading",i.isLoading())}}function N(n,s){if(1&n&&(e.qex(0),e.nrm(1,"p-button",41),e.bVm()),2&n){const i=e.XpG();e.R7$(),e.Y8G("disabled",i.counterForm.invalid||i.isLoading())("loading",i.isLoading())}}function x(n,s){if(1&n){const i=e.RV6();e.qex(0),e.j41(1,"p-button",42),e.bIt("click",function(){a.eBV(i);const t=e.XpG();return a.Njj(t.onCancel())}),e.k0s(),e.j41(2,"p-button",43),e.bIt("click",function(){a.eBV(i);const t=e.XpG();return a.Njj(t.onEditCounter())}),e.k0s(),e.bVm()}}let K=(()=>{class n{constructor(){this.counterService=(0,a.WQX)(k._),this.fb=(0,a.WQX)(l.ok),this.messageService=(0,a.WQX)(y.bg),this.route=(0,a.WQX)(C.nX),this.router=(0,a.WQX)(C.Ix),this.mode=(0,a.vPA)("create"),this.counterId=(0,a.vPA)(null),this.isLoading=(0,a.vPA)(!1),this.baseUrl=M.p,this.selectedFile=null,this.isEditMode=(0,d.EW)(()=>"edit"===this.mode()),this.isCreateMode=(0,d.EW)(()=>"create"===this.mode()),this.isViewMode=(0,d.EW)(()=>"view"===this.mode()),this.isFormValid=(0,d.EW)(()=>{if(!this.counterForm)return!1;const i=this.counterForm.valid;return this.isCreateMode()?i&&!!this.selectedFile:i}),this.pageTitle=(0,d.EW)(()=>{switch(this.mode()){case"create":return"Create New Blog";case"edit":return"Edit Blog Mode";case"view":return"View Blog Mode";default:return"Blog Form"}}),(0,d.QZ)(()=>{this.counterForm&&(this.isViewMode()?this.counterForm.disable():this.counterForm.enable())})}ngOnInit(){this.initForm(),this.setupRouteHandling()}setupRouteHandling(){this.route.data.subscribe(i=>{this.mode.set(i.mode||"create")}),this.route.params.subscribe(i=>{const r=i.id;r&&(this.counterId.set(+r),this.loadCounterData(+r))})}initForm(){this.counterForm=this.fb.group({en_counter_title:["",[l.k0.required,l.k0.minLength(3)]],ar_counter_title:["",[l.k0.required,l.k0.minLength(3)]],counter_number:["",[l.k0.required,l.k0.min(1)]],en_alt_image:["",[l.k0.required,l.k0.minLength(3)]],ar_alt_image:["",[l.k0.required,l.k0.minLength(3)]]})}loadCounterData(i){const r=i||this.counterId()||1;this.counterService.getCounter(r).subscribe({next:t=>{this.counter=t.data,this.counterForm.patchValue({en_counter_title:this.counter.en_counter_title,ar_counter_title:this.counter.ar_counter_title,counter_number:this.counter.counter_number,main_image:this.counter.main_image,en_alt_image:this.counter.en_alt_image,ar_alt_image:this.counter.ar_alt_image}),this.isLoading.set(!1)},error:t=>{console.error("Error loading blog data:",t),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to load blog data"}),this.isLoading.set(!1)}})}onImageSelect(i){const r=i.files||i.currentFiles;if(r&&r.length>0){const t=r[0];if(!t.type.startsWith("image/"))return void this.messageService.add({severity:"error",summary:"Invalid File",detail:"Please select an image file"});if(t.size>5e6)return void this.messageService.add({severity:"error",summary:"File Too Large",detail:"Please select an image smaller than 5MB"});this.selectedFile=t,this.messageService.add({severity:"success",summary:"File Selected",detail:`Image "${t.name}" selected successfully`})}}onSubmit(){if(!this.isFormValid()||this.isViewMode())return void this.messageService.add({severity:"warn",summary:"Warning",detail:this.isCreateMode()&&!this.selectedFile?"Please select an image file and fill all required fields":"Please fill all required fields correctly"});this.isLoading.set(!0);const i=this.counterForm.value;this.isCreateMode()?this.createCounter(i):this.isEditMode()&&this.updateCounter()}createCounter(i){if(!this.selectedFile)return this.messageService.add({severity:"warn",summary:"Warning",detail:"Please select an image file"}),void this.isLoading.set(!1);this.counterService.addUpdateCounter(i,this.selectedFile).subscribe({next:r=>{console.log("Create successful:",r),this.messageService.add({severity:"success",summary:"Success",detail:"Counter created successfully"}),this.router.navigate(["/dashboard/counters"])},error:r=>{console.error("Error creating counter:",r),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to create counter"}),this.isLoading.set(!1)}})}updateCounter(){this.isLoading.set(!0);const i=this.counterForm.value;console.log(i),this.counterService.addUpdateCounter(i,this.selectedFile||void 0,this.counter.id).subscribe({next:r=>{console.log("Update successful:",r),this.messageService.add({severity:"success",summary:"Success",detail:"Counter updated successfully"}),this.loadCounterData(),this.isLoading.set(!1)},error:r=>{console.error("Error updating counter:",r),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update counter"}),this.isLoading.set(!1)}})}onCancel(){this.router.navigate(["/dashboard/counters"])}onEditCounter(){this.counterId()&&this.router.navigate(["../../edit",this.counterId()],{relativeTo:this.route})}static#e=this.\u0275fac=function(r){return new(r||n)};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-counter-id"]],decls:48,vars:47,consts:[["empty",""],[1,"grid"],[1,"col-12"],["styleClass","shadow-2",3,"header"],[1,"p-fluid"],[3,"ngSubmit","formGroup"],[1,"grid","mt-4"],[1,"col-12","md:col-6"],[1,"text-2xl","font-bold","mb-4"],[1,"field","mb-3"],["for","en_counter_title",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","en_counter_title","formControlName","en_counter_title","placeholder","Enter English counter title",2,"width","100%",3,"readonly"],["class","p-error block",4,"ngIf"],["for","en_alt_image",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","en_alt_image","formControlName","en_alt_image","placeholder","Enter English alt image text",2,"width","100%",3,"readonly"],[1,"col-12","md:col-6","right-side"],["for","ar_counter_title",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","ar_counter_title","formControlName","ar_counter_title","placeholder","Enter Arabic counter title",2,"width","100%",3,"readonly"],["for","ar_alt_image",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","ar_alt_image","formControlName","ar_alt_image","placeholder","Enter Arabic alt image text",2,"width","100%",3,"readonly"],["class","col-12",4,"ngIf"],["for","counter_number",1,"block","text-900","font-medium","mb-2"],["pInputText","","id","counter_number","formControlName","counter_number","placeholder","Enter counter number","type","number",2,"width","100%",3,"readonly"],["class","field col-12",4,"ngIf"],[1,"flex","justify-content-end","gap-2","pt-3"],[4,"ngIf"],[1,"p-error","block"],[1,"field"],[1,"block","text-900","font-medium","mb-2"],[1,"border-1","border-300","border-round","p-3","text-center"],[1,"w-full","max-w-20rem","h-auto","border-round","shadow-2",2,"max-height","300px","object-fit","cover",3,"src","alt"],[1,"field","col-12"],["class","text-red-500",4,"ngIf"],["name","main_image","accept","image/*","maxFileSize","5000000","mode","advanced","chooseLabel","Choose Image","uploadLabel"," ","cancelLabel","Cancel",3,"onSelect","multiple","auto"],["class","p-error block","style","margin-top: 10px",4,"ngIf"],[1,"text-red-500"],[1,"text-center","p-4"],[1,"pi","pi-cloud-upload","text-4xl","text-300"],[1,"mt-2","mb-0"],[1,"p-error","block",2,"margin-top","10px"],["label","Create Counter","icon","pi pi-plus","severity","primary","type","submit",3,"loading"],["label","Update Counter","icon","pi pi-check","severity","primary","type","submit",3,"disabled","loading"],["label","Back","icon","pi pi-arrow-left","severity","secondary","type","button",3,"click"],["label","Edit","icon","pi pi-pencil","severity","primary","type","button",3,"click"]],template:function(r,t){if(1&r&&(e.j41(0,"div",1)(1,"div",2)(2,"p-card",3)(3,"div",4)(4,"form",5),e.bIt("ngSubmit",function(){return t.onSubmit()}),e.j41(5,"div",6)(6,"div",7)(7,"h2",8),e.EFF(8,"English Content"),e.k0s(),e.j41(9,"div",9)(10,"label",10),e.EFF(11," Counter Title "),e.k0s(),e.nrm(12,"input",11),e.DNE(13,L,2,0,"small",12),e.k0s(),e.j41(14,"div",9)(15,"label",13),e.EFF(16," Alt Image Text "),e.k0s(),e.nrm(17,"input",14),e.DNE(18,j,2,0,"small",12),e.k0s()(),e.j41(19,"div",15)(20,"h2",8),e.EFF(21,"Arabic Content"),e.k0s(),e.j41(22,"div",9)(23,"label",16),e.EFF(24," Counter Title "),e.k0s(),e.nrm(25,"input",17),e.DNE(26,w,2,0,"small",12),e.k0s(),e.j41(27,"div",9)(28,"label",18),e.EFF(29," Alt Image Text "),e.k0s(),e.nrm(30,"input",19),e.DNE(31,G,2,0,"small",12),e.k0s()(),e.DNE(32,O,6,3,"div",20),e.j41(33,"div",2)(34,"h2",8),e.EFF(35,"Additional Information"),e.k0s(),e.j41(36,"div",9)(37,"label",21),e.EFF(38," Counter Number "),e.k0s(),e.nrm(39,"input",22),e.DNE(40,S,2,0,"small",12),e.k0s(),e.DNE(41,Y,8,4,"div",23),e.k0s(),e.j41(42,"div",2)(43,"div",24),e.DNE(44,U,2,1,"ng-container",25)(45,N,2,2,"ng-container",25)(46,x,3,0,"ng-container",25),e.k0s()()()()()()()(),e.nrm(47,"p-toast")),2&r){let u,c,_,g,h,f,p,v,b,E;e.R7$(2),e.Y8G("header",t.pageTitle()),e.R7$(2),e.Y8G("formGroup",t.counterForm),e.R7$(8),e.Aen(e.eq3(37,m,t.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(u=t.counterForm.get("en_counter_title"))?null:u.invalid)&&(null==(u=t.counterForm.get("en_counter_title"))?null:u.touched)),e.Y8G("readonly",t.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(c=t.counterForm.get("en_counter_title"))?null:c.invalid)&&(null==(c=t.counterForm.get("en_counter_title"))?null:c.touched)&&!t.isViewMode()),e.R7$(4),e.Aen(e.eq3(39,m,t.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(_=t.counterForm.get("en_alt_image"))?null:_.invalid)&&(null==(_=t.counterForm.get("en_alt_image"))?null:_.touched)),e.Y8G("readonly",t.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(g=t.counterForm.get("en_alt_image"))?null:g.invalid)&&(null==(g=t.counterForm.get("en_alt_image"))?null:g.touched)&&!t.isViewMode()),e.R7$(7),e.Aen(e.eq3(41,m,t.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(h=t.counterForm.get("ar_counter_title"))?null:h.invalid)&&(null==(h=t.counterForm.get("ar_counter_title"))?null:h.touched)),e.Y8G("readonly",t.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(f=t.counterForm.get("ar_counter_title"))?null:f.invalid)&&(null==(f=t.counterForm.get("ar_counter_title"))?null:f.touched)&&!t.isViewMode()),e.R7$(4),e.Aen(e.eq3(43,m,t.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(p=t.counterForm.get("ar_alt_image"))?null:p.invalid)&&(null==(p=t.counterForm.get("ar_alt_image"))?null:p.touched)),e.Y8G("readonly",t.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(v=t.counterForm.get("ar_alt_image"))?null:v.invalid)&&(null==(v=t.counterForm.get("ar_alt_image"))?null:v.touched)&&!t.isViewMode()),e.R7$(),e.Y8G("ngIf",null==t.counter?null:t.counter.main_image),e.R7$(7),e.Aen(e.eq3(45,m,t.isViewMode()?"#f0f0f0":"white")),e.AVh("ng-invalid",(null==(b=t.counterForm.get("counter_number"))?null:b.invalid)&&(null==(b=t.counterForm.get("counter_number"))?null:b.touched)),e.Y8G("readonly",t.isViewMode()),e.R7$(),e.Y8G("ngIf",(null==(E=t.counterForm.get("counter_number"))?null:E.invalid)&&(null==(E=t.counterForm.get("counter_number"))?null:E.touched)&&!t.isViewMode()),e.R7$(),e.Y8G("ngIf",!t.isViewMode()),e.R7$(3),e.Y8G("ngIf",t.isCreateMode()),e.R7$(),e.Y8G("ngIf",t.isEditMode()),e.R7$(),e.Y8G("ngIf",t.isViewMode())}},dependencies:[I.Y,D.ef,T.bT,R.$n,V.Sm,P.Zp,A.y8,l.qT,l.me,l.Q0,l.BC,l.cb,l.j4,l.JD],styles:[".p-fileupload-upload-button{display:none!important}  .p-fileupload-file-badge{display:none!important}  .ql-disabled .ql-editor{background-color:#cbd5e1!important;color:#475569}  .ql-editor .ql-direction-rtl{text-align:right!important}"]})}return n})()}}]);