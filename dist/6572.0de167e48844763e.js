"use strict";(self.webpackChunkfree_version=self.webpackChunkfree_version||[]).push([[6572],{6572:(W,d,a)=>{a.r(d),a.d(d,{Counter:()=>L});var r=a(8728),m=a(9211),C=a(1256),f=a(5512),v=a(5731),g=a(5779),p=a(1314),E=a(980),t=a(3664),c=a(5531),M=a(8132),h=a(4341),T=a(2292),b=a(1020);const F=()=>({"min-width":"50rem"}),D=()=>["create"],O=()=>({width:"50px",height:"50px",borderRadius:"50%"}),R=s=>["view",s],S=s=>["edit",s];function j(s,u){1&s&&t.nrm(0,"p-button",1),2&s&&t.Y8G("routerLink",t.lJ4(1,D))}function P(s,u){if(1&s){const e=t.RV6();t.j41(0,"tr")(1,"th",6),t.EFF(2," ID "),t.nrm(3,"p-sortIcon",7),t.k0s(),t.j41(4,"th",8),t.EFF(5," Title "),t.nrm(6,"p-sortIcon",9),t.k0s(),t.j41(7,"th"),t.EFF(8,"Image"),t.k0s(),t.j41(9,"th",10),t.EFF(10," Number "),t.nrm(11,"p-sortIcon",11),t.k0s(),t.j41(12,"th"),t.EFF(13,"View"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Edit"),t.k0s(),t.j41(16,"th",12)(17,"div",13)(18,"span"),t.EFF(19,"Status"),t.k0s(),t.j41(20,"p-select",14),t.mxI("ngModelChange",function(i){r.eBV(e);const o=t.XpG();return t.DH7(o.selectedStatusFilter,i)||(o.selectedStatusFilter=i),r.Njj(i)}),t.bIt("ngModelChange",function(i){r.eBV(e);const o=t.XpG();return r.Njj(o.onStatusFilter(i))}),t.k0s()()()()}if(2&s){const e=t.XpG();t.R7$(20),t.Y8G("options",e.statusOptions),t.R50("ngModel",e.selectedStatusFilter),t.Y8G("showClear",!0)}}function I(s,u){1&s&&t.nrm(0,"i",22)}function x(s,u){if(1&s){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td",15),t.EFF(4),t.k0s(),t.j41(5,"td"),t.nrm(6,"img",16),t.k0s(),t.j41(7,"td"),t.EFF(8),t.k0s(),t.j41(9,"td")(10,"a",17),t.nrm(11,"i",18),t.k0s()(),t.j41(12,"td")(13,"a",17),t.nrm(14,"i",19),t.k0s()(),t.j41(15,"td")(16,"div",20)(17,"p-toggleswitch",21),t.bIt("ngModelChange",function(){const i=r.eBV(e).$implicit,o=t.XpG();return r.Njj(o.onToggleChange(i))}),t.k0s(),t.nVh(18,I,1,0,"i",22),t.k0s()()()}if(2&s){const e=u.$implicit,n=t.XpG();t.R7$(2),t.JRh(e.id),t.R7$(2),t.JRh(e.en_counter_title),t.R7$(2),t.Aen(t.lJ4(11,O)),t.Y8G("src",n.baseUrl+e.main_image,t.B4B),t.R7$(2),t.JRh(e.counter_number),t.R7$(2),t.Y8G("routerLink",t.eq3(12,R,e.id)),t.R7$(3),t.Y8G("routerLink",t.eq3(14,S,e.id)),t.R7$(4),t.Y8G("ngModel",n.returnStatus(e.active_status))("disabled",n.isToggleLoading(e.id)),t.R7$(),t.vxM(n.isToggleLoading(e.id)?18:-1)}}function y(s,u){1&s&&(t.j41(0,"tr")(1,"td",23)(2,"div",24),t.nrm(3,"i",25),t.j41(4,"span",26),t.EFF(5,"No data found"),t.k0s()()()())}let L=(()=>{class s{constructor(){this.route=(0,r.WQX)(m.nX),this.messageService=(0,r.WQX)(g.bg),this.counters=[],this.allCounters=[],this.baseUrl=C.p,this.counterService=(0,r.WQX)(f._),this.checked=!1,this.loadingToggles=new Set,this.statusOptions=[{label:"Active",value:1},{label:"Inactive",value:0}],this.selectedStatusFilter=null}getMode(){return this.route.snapshot.queryParamMap.get("mode")}getSliderId(){return this.route.snapshot.queryParamMap.get("id")}ngOnInit(){this.counterService.getCounters().subscribe(e=>{this.allCounters=e.data,this.counters=e.data})}returnStatus(e){return 1==e}isToggleLoading(e){return this.loadingToggles.has(e)}onToggleChange(e){if(this.isToggleLoading(e.id))return;this.loadingToggles.add(e.id);const n=e.active_status,i=1===Number(e.active_status)?0:1;e.active_status=i;const o=this.allCounters.findIndex(l=>l.id===e.id);-1!==o&&(this.allCounters[o].active_status=i),(1===Number(n)?this.counterService.disableCounter(e.id):this.counterService.activeCounter(e.id)).pipe((0,E.j)(()=>{this.loadingToggles.delete(e.id)})).subscribe({next:l=>{if(l.data&&l.data.length>0){const _=l.data.find(B=>B.id===e.id);_&&(e.active_status=_.active_status,-1!==o&&(this.allCounters[o].active_status=_.active_status))}this.messageService.add({severity:"success",summary:"Success",detail:`Counter ${1===i?"activated":"deactivated"} successfully`})},error:l=>{e.active_status=n,-1!==o&&(this.allCounters[o].active_status=n),console.error("Toggle failed:",l),this.messageService.add({severity:"error",summary:"Error",detail:"Failed to update counter status"})}})}getStatusOption(e){return e}onStatusFilter(e){this.counters=null==e?[...this.allCounters]:this.allCounters.filter(n=>Number(n.active_status)===Number(e))}onStatusChange(e){const n=this.allCounters.find(i=>i.id===e);n&&this.onToggleChange(n)}onDelete(e){const n=this.allCounters.find(i=>i.id===e);n&&this.onToggleChange(n)}onActive(e){const n=this.allCounters.find(i=>i.id===e);n&&this.onToggleChange(n)}static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275cmp=t.VBU({type:s,selectors:[["app-counter"]],decls:8,vars:4,consts:[[1,"flex","justify-content-between","items-center","mb-4","w-full"],["label","Create New Counter","icon","pi pi-plus","severity","primary",3,"routerLink"],[3,"value","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pSortableColumn","id"],["field","id"],["pSortableColumn","en_counter_title"],["field","en_counter_title"],["pSortableColumn","counter_number"],["field","counter_number"],["pSortableColumn","active_status",2,"max-width","50px"],[1,"flex","flex-column","gap-2"],["optionLabel","label","optionValue","value","appendTo","body","placeholder","Filter by Status",3,"ngModelChange","options","ngModel","showClear"],[2,"width","25%"],["alt","counter",3,"src"],[3,"routerLink"],[1,"pi","pi-eye",2,"color","#673ab7"],[1,"pi","pi-pencil",2,"color","#673ab7"],[1,"flex","align-items-center","gap-2"],[3,"ngModelChange","ngModel","disabled"],[1,"pi","pi-spin","pi-spinner",2,"color","#673ab7","font-size","0.8rem"],["colspan","12",1,"text-center","p-4"],[1,"flex","flex-column","align-items-center","justify-content-center"],[1,"pi","pi-info-circle",2,"font-size","2rem","color","var(--text-color-secondary)"],[1,"mt-2",2,"color","var(--text-color-secondary)"]],template:function(n,i){1&n&&(t.j41(0,"div",0)(1,"h2"),t.EFF(2,"Counter Management"),t.k0s(),t.nVh(3,j,1,2,"p-button",1),t.k0s(),t.j41(4,"p-table",2),t.DNE(5,P,21,3,"ng-template",3)(6,x,19,16,"ng-template",4)(7,y,6,0,"ng-template",5),t.k0s()),2&n&&(t.R7$(3),t.vxM(i.counters.length<6?3:-1),t.R7$(),t.Y8G("value",i.counters)("tableStyle",t.lJ4(3,F)))},dependencies:[v.g,c.XI,g.Ei,c.Tg,c.yc,M.Wk,h.BC,h.vS,T.jF,b.$n,p.py,p.l6],encapsulation:2})}return s})()}}]);